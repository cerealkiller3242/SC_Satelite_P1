#include "memory_map.h"

// Prototipos
extern void kernel_start(int *temps, int len);

// Temperatura array - almacenado en sección .data (no en stack)
// TEMPERATURAS_SET define cuál set de temperaturas usar (1-4)
// Por defecto usa SET 1, modificar con: -DTEMPERATURAS_SET=2 en CFLAGS
#ifndef TEMPERATURAS_SET
#define TEMPERATURAS_SET 1
#endif

// ==========================================
// SET 1: Órbita LEO completa con anomalías
// ==========================================
#if TEMPERATURAS_SET == 1
int temps_array[100] = {
    45, 48, 52, 56, 61, 65, 70, 75, 80, 85,
    90, 95, 98, 101, 103, 105, 103, 101, 98, 95, 
    90, 85, 80, 75, 70, 65, 60, 55, 50, 45, 
    43, 46, 50, 55, 60, 65, 70, 75, 80, 85,
    90, 95, 100, 102, 104, 102, 100, 95, 90, 85,
    80, 75, 70, 65, 60, 55, 50, 45, 43, 45,
    50, 55, 60, 65, 70, 75, 80, 85, 90, 95,
    98, 100, 103, 105, 103, 100, 98, 95, 90, 85,
    80, 75, 70, 65, 60, 55, 50, 45, 43, 45,
    50, 55, 60, 65, 70, 75, 80, 85, 90, 92 
};

// ====================================
// SET 2: Con variaciones aleatorias
// ====================================
#elif TEMPERATURAS_SET == 2
int temps_array[100] = {
    76, 70, 102, 98, 98, 80, 72, 92, 83, 55,
    57, 65, 87, 57, 88, 94, 71, 88, 90, 93,
    65, 81, 95, 97, 85, 71, 82, 75, 69, 66,
    52, 58, 63, 89, 77, 94, 97, 54, 58, 77,
    77, 97, 97, 100, 74, 92, 58, 58, 90, 96,
    100, 100, 54, 103, 74, 66, 94, 49, 100, 77,
    46, 80, 57, 62, 88, 73, 105, 64, 103, 62,
    76, 57, 95, 92, 62, 50, 70, 96, 100, 99,
    87, 94, 77, 79, 66, 69, 65, 70, 90, 58,
    66, 97, 85, 88, 70, 73, 88, 79, 61, 72
};

// =====================================
// SET 3: Constante (100°C)
// =====================================
#elif TEMPERATURAS_SET == 3
int temps_array[100] = {
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
    100, 100, 100, 100, 100, 100, 100, 100, 100, 100
};

// =============================================
// SET 4: Caso anómalo con saltos grandes
// =============================================
#elif TEMPERATURAS_SET == 4
int temps_array[100] = {
    45, 46, 47, 48, 49, 50, 51, 52, 53, 54,
    105, 104, 103, 102, 101, 100, 99, 98, 97, 96,  // SALTO: 54→105 (pico térmico)
    45, 46, 47, 48, 49, 50, 51, 52, 53, 54,        // CAÍDA: 96→45 (anomalía)
    105, 104, 103, 102, 101, 100, 99, 98, 97, 96,  // SALTO: 54→105 (repetición)
    50, 55, 60, 65, 70, 75, 80, 85, 90, 95,
    105, 105, 105, 105, 105, 100, 95, 90, 85, 80,  // Meseta alta
    45, 45, 45, 45, 45, 50, 55, 60, 65, 70,        // CAÍDA brusca a 45
    100, 101, 102, 103, 104, 105, 105, 105, 105, 105,  // SUBIDA brusca a 105
    50, 51, 52, 53, 54, 55, 56, 57, 58, 59,        // Descenso controlado
    60, 61, 62, 63, 64, 65, 66, 67, 68, 69         // Ascenso controlado
};

#else
#error "TEMPERATURAS_SET debe ser 1, 2, 3 o 4"
#endif



int main() {
    // Escenario seleccionado (1-4) - definido por Makefile
    current_scenario = SCENARIO;  
    
    // Iniciar el kernel con el array de temperaturas
    kernel_start(temps_array, 100);
    
    // Loop infinito (el scheduler nunca retorna)
    while(1);
    
    return 0;
}
